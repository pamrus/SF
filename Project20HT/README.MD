Модуль 20. Основы работы с сетью. Создание сетевых приложений
=====================================================================
20.11. Задание по итогам модуля
======================

ЗАДАЧА: 
1. Сделайте ваш чат сетевым, то есть доработайте его так, чтобы два экземпляра программы могли отправлять и принимать сообщения между собой.
Используйте протокол UPD или TCP на свое усмотрение.
	Можно использовать архитектуру клиент-сервер, в этом случае будут две программы — клиент и сервер.
	Можно использовать децентрализованную (англ. peer-to-peer, P2P — равный к равному) сеть, в которой каждый узел является как клиентом, так и выполняет функции сервера.
2. Задание повышенной сложности (то самое, со звездочкой*)
    Сделайте ваш чат кроссплатформенным, т.е. чтобы он компилировался и работал в Linux и в Windows.


Использован протокол TCP (маленький пинг не нужен, важен порядок следования данных), архитектура клиент-сервер, библиотека Boost.Asio.
Полноценного чата на основе предыдущих наработок путём добавления поддержки сети создать не удалось. За основу были взяты примеры из https://github.com/Vasilui/habrahabr/tree/master/Boost.Asio_C%2B%2B_Network_Programming/Chapter_4 (async_~). Определённые сложности возникли с разделением единых файлов на "main"-файлы и файлы сетевых классов. Работа по связи с бессетевым чатом активно идёт, но всё ещё остаётся много нерешённых проблем. Поэтому выкладываю рабочие, но неполнофункциональные заготовки, демонстрирующие асинхронно-запрограммированные сокеты (так как многопоточность мы ещё не проходили - пусть она крутится сама по себе в недрах библиотечного кода, а мы будем работать в одном потоке периодически переключаясь на функции-обработчики событий). Связка сервер-клиенты (до 18 подключений одновременно) проверена на нескольких машинах под windows и linux в пределах локальной сети.


Требуемые для сборки параметры Visual Studio:
1) C/C++ -> Общие -> Дополнительные каталоги включаемых файлов:	c:\Program Files\boost_1_78_0\
2) C/C++ -> Создание кода -> Библиотека времени выполнения:		/MTd
3) C/C++ -> Препроцессор -> Определения препроцессора:			_WIN32_WINNT=0x0601
4) Компоновщик -> Дополнительные каталоги библиотек:			c:\Program Files\boost_1_78_0\stage\lib\
5) Компоновщик -> Командная строка:								/FORCE:MULTIPLE
Последний параметр нужен для сервера - заставляет игнорировать ошибку "fatal error LNK1169: обнаружен многократно определенный символ - один или более" с clientsArrayType clientsArray. Корректно решить проблему не смог (external пробовал).


Требуемые для сборки под linux параметры gcc:
g++ ./server/main.cpp ./server/ServerToClientConnection.cpp -o server.elf -L /usr/lib/ -lboost_system -lboost_thread -lpthread  -zmuldefs
g++ ./client/main.cpp ./client/ClientToServerConnection.cpp -o client.elf -L /usr/lib/ -lboost_system -lboost_thread -lpthread 


Библиотека Boost должна быть собрана с параметром "runtime-link=static"!
/usr/local/lib должен быть в LD_LIBRARY_PATH!


Для клиента IP-адрес сервера передаётся в виде единственного параметра коммандной строки (Отладка - Аргументы команды).


Решение: Александр Павлинов 2022.01.13
